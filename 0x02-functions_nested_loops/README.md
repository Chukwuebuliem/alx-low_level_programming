This entails the functions in nexted loop
